<!DOCTYPE html>
<html>
<head>
    <title>Track Motorbikes with Paths</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        #map {
            height: 500px;
            width: 100%;
        }
        .controls {
            margin-top: 10px;
        }
        .controls button {
            margin-right: 10px;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Track Motorbikes with Paths</h1>
    <div id="map"></div>
    <div class="controls">
        <button id="toggle-tracking">Track Bikes</button>
        <button id="show-paths">Show Paths</button>
    </div>

    <script>
        // Initialize Leaflet Map
        var map = L.map('map').setView([21.0227396, 105.8369637], 13);

        // Add OpenStreetMap Tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // Define bike icons with provided images
        function createBikeIcon(url) {
            return L.icon({
                iconUrl: url,
                iconSize: [40, 40], // Icon size
                iconAnchor: [20, 20], // Anchor point
                popupAnchor: [0, -20] // Popup position
            });
        }

        // Bike Data
        var bikes = [
            { 
                name: "Bike 1", 
                icon: createBikeIcon("https://i.postimg.cc/wxQSHhBT/bike-1.webp"), 
                path: [[21.0227396, 105.8369637], [21.0235, 105.8377], [21.0248, 105.8389], [21.0260, 105.8372]],
                marker: null 
            },
            { 
                name: "Bike 2", 
                icon: createBikeIcon("https://i.postimg.cc/8PkxCjFd/bike-2.webp"), 
                path: [[21.0247396, 105.8379637], [21.0252, 105.8392], [21.0265, 105.8384], [21.0278, 105.8377]],
                marker: null 
            },
            { 
                name: "Bike 3", 
                icon: createBikeIcon("https://i.postimg.cc/3JLV0Yps/bike-3.webp"), 
                path: [[21.0267396, 105.8399637], [21.0275, 105.8389], [21.0288, 105.8401], [21.0290, 105.8375]],
                marker: null 
            }
        ];

        // Initialize Markers
        bikes.forEach((bike) => {
            bike.marker = L.marker(bike.path[0], { icon: bike.icon })
                .bindPopup(`${bike.name} is here!`);
        });

        // Toggle Tracking Button
        var trackingEnabled = false;
        function toggleTracking() {
            trackingEnabled = !trackingEnabled;
            bikes.forEach((bike) => {
                if (trackingEnabled) {
                    bike.marker.addTo(map); // Add bike markers
                } else {
                    map.removeLayer(bike.marker); // Remove bike markers
                }
            });

            document.getElementById("toggle-tracking").innerText = trackingEnabled
                ? "Stop Tracking"
                : "Track Bikes";
        }

        // Show Paths Button
        var pathPolylines = [];
        function showPaths() {
            // Remove paths if already shown
            if (pathPolylines.length > 0) {
                pathPolylines.forEach((polyline) => map.removeLayer(polyline));
                pathPolylines = [];
                document.getElementById("show-paths").innerText = "Show Paths";
                return;
            }

            // Draw paths
            bikes.forEach((bike) => {
                const polyline = L.polyline(bike.path, { color: "blue", weight: 2 }).addTo(map);
                pathPolylines.push(polyline);
            });

            document.getElementById("show-paths").innerText = "Hide Paths";
        }

        // Simulate Bike Movement
        function moveBike(bike) {
            let i = 0;
            setInterval(() => {
                if (trackingEnabled) {
                    bike.marker.setLatLng(bike.path[i]); // Update position
                    i = (i + 1) % bike.path.length; // Loop through path
                }
            }, 2000); // Every 2 seconds
        }

        // Start Moving Each Bike
        bikes.forEach((bike) => moveBike(bike));

        // Attach Event Listeners
        document.getElementById("toggle-tracking").addEventListener("click", toggleTracking);
        document.getElementById("show-paths").addEventListener("click", showPaths);
    </script>
</body>
</html>
